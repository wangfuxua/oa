<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="JKTD-D-丁亚娟" />
<title>用户管理</title>
<link rel="stylesheet" type="text/css" href="../Public/css/default.css" />
<script type="text/javascript" src="../Public/js/iframe.js" ></script>
<script type="text/javascript" src="../Public/js/tree.js"></script>
<script type="text/javascript" src="../Public/js/js.js"></script>
</head>
		<script type="text/javascript">
			////////////////////////////////
$(document).ready(function() {
    //var val = $("#userSearch input").val(); 
    /* 
    $("#userSearch input").keyup(function() {
   	
        var val = $(this).val();
        var tree = $("#onlineTree");
        var box = $("#searchResult");
        if (val != "") {
            tree.hide();
            box.show();
            box.empty();
            var result = $(".sTreeNode:contains('" + $(this).val() + "')");
           result.each(function(i) {
                $(this).clone().appendTo(box);
            });
			$("#searchResult .oTree-bg").remove();
	        $("#searchResult img[src$='empty.gif']").remove();
        } else {
            tree.show();
            box.empty();
            box.hide();
        }

    });
*/    
    	   $("#searchKey").keyup(function() {
	            formValue();
	        });
});
	    function filterData(box, toBox, val) {
	        var result = box.find("p[name*='" + val + "']").parents(".sTreeNode");
	        result.each(function(i) {
	            $(this).clone().appendTo(toBox);
	        });
	    }
	    
	    function sRemove(box) {
	        box.find(".oTree-bg").remove().end()
	             .find("img[src$='empty.gif']").remove();
	    }
	    
	    function formValue() {
	       // var sValue = $("#searchState").val();
	        var kValue = $("#searchKey").val();
	        var uTree = $("#onlineTree");
	        var vbox = $("#ResultBox");    // 结果box：valueBox
	        var hbox = $("#StateBox");      // 中转box：hiddenBox

	            uTree.hide();
	            hbox.empty().hide();
	            vbox.empty().show();
	            
	            if (kValue != "") {
	                filterData(hbox, vbox, kValue);
	            } else {
	                uTree.show();
	                vbox.empty().hide();
	            }
	        sRemove(vbox);
	    }
		</script>
<body>
	<table width="100%" border="0" cellspacing="0" cellpadding="0">
		<tr>
			<td class="dm_personl tdtop" valign="top">
	<div id="userSearch" style="width:98%; margin-left:0px;padding-left:0px">
		<form action="">
			<input type="text" value="请输入姓名" id="searchKey" style="width:100%;margin-left:0px;padding-left:0px" onclick="this.value=''"/>
		</form>
	</div>			
			    <div class="userTree" id="onlineTree">
			        <div class="dm_menu_a"><b></b>在职人员</div>
			        <script type="text/javascript">
				        <!--
			            var online = new sTree('online');
			            online.config.folderLinks = true;
			            online.icon = {
					       root: '../Public/img/empty.gif', 			
					        folder: '../Public/img/folder.gif', 			
					        folderOpen: '../Public/img/folderopen.gif', 
					        node: '../Public/images/bg_4x7.gif', 		
					        empty: '../Public/img/empty.gif', 			
					        line: '../Public/img/line.gif', 			
					        join: '../Public/img/join.gif', 			
					        joinBottom: '../Public/img/joinbottom.gif', 		
					        plus: '../Public/img/plus.gif', 			
					        plusBottom: '../Public/img/plusbottom.gif',
					        minus: '../Public/img/minus.gif',
					        minusBottom: '../Public/img/minusbottom.gif',
					        nlPlus: '../Public/img/nolines_plus.gif',
					        nlMinus: '../Public/img/nolines_minus.gif'
					    };
				       // id, pid, name, url, title, target, icon, iconOpen, open, cls
			            online.add(0, -1, '金凯通达', '', '', '', '../Public/images/ico/company-ico.gif', '../Public/images/ico/company-ico.gif', '', 'tree-root');
			            
			<volist name="deptlist" id="vo" key="k">
			    online.add({$vo[DEPT_ID]},{$vo[DEPT_PARENT]},'[{$vo.DEPT_NAME}]','__URL__/userlist/DEPT_ID/{$vo[DEPT_ID]}','','user_main','../Public/images/user/user_group.gif','../Public/images/user/user_group.gif','','');
			    <sublist name="vo[user]" id="user">
			      online.add('{$user[USER_ID]}',{$vo[DEPT_ID]},'{$user.USER_NAME}','__URL__/userEdit/USER_ID/{$user.USER_ID}','','user_main','../Public/images/ico/user.png','','','',{$user[UserState]|json_encode});
			    </sublist>
			</volist>
						            
			            document.write(online);
				        //-->
			        </script>
			        <div class="dm_menu_a"><b></b>离职/外部人员</div>
			        
			        <script type="text/javascript">
				        <!--
			            var outuser = new sTree('outuser');
			            outuser.config.folderLinks = true;
			            outuser.icon = {
					       root: '../Public/img/empty.gif', 			
					        folder: '../Public/img/folder.gif', 			
					        folderOpen: '../Public/img/folderopen.gif', 
					        node: '../Public/images/bg_4x7.gif', 		
					        empty: '../Public/img/empty.gif', 			
					        line: '../Public/img/line.gif', 			
					        join: '../Public/img/join.gif', 			
					        joinBottom: '../Public/img/joinbottom.gif', 		
					        plus: '../Public/img/plus.gif', 			
					        plusBottom: '../Public/img/plusbottom.gif',
					        minus: '../Public/img/minus.gif',
					        minusBottom: '../Public/img/minusbottom.gif',
					        nlPlus: '../Public/img/nolines_plus.gif',
					        nlMinus: '../Public/img/nolines_minus.gif'
					    };
				       // id, pid, name, url, title, target, icon, iconOpen, open, cls
			            outuser.add(0, -1, '金凯通达', '', '', '', '../Public/images/ico/company-ico.gif', '../Public/images/ico/company-ico.gif', '', 'tree-root');
			            {$treeoutuser}
			            document.write(outuser);
				        //-->
			        </script>
			        			        
			    </div>
		<div id="StateBox"></div>
        <div id="ResultBox">	</div>
		<div id="test" style="display:none"></div>			    
<div id="searchResult">	</div>			    
			</td>
			<td class="dm_personr tdtop">

			<script type="text/javascript">
			    iframe('__URL__/userlist/{$depturl}', '100%', '600', 'user_main');
	        </script>
			</td>
		</tr>
	</table>
</body>
</html>
