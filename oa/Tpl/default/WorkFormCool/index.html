<include file="Public:header" />

<script Language="JavaScript">
self.moveTo(0,0);
self.resizeTo(screen.availWidth,screen.availHeight);
self.focus();

function CheckForm()
{
   if(EDIT_HTML.get_docHtml()=="")
   { alert("表单内容不能为空！");
     return (false);
   }
   return (true);
}

function send()
{
 if(CheckForm())
 {
   if(EDIT_HTML.switchMode.checked == true)
   {
      alert("源文件模式，不能保存！");
      return;
   }

   document.form1.CONTENT.value=EDIT_HTML.get_docHtml();
   document.form1.submit();
 }
}

function myclose()
{
 msg='关闭表单设计器前，保存对表单的修改？';
 if(window.confirm(msg))
 {
   document.form1.CLOSE_FLAG.value="1";
   send();
 }
 else
   window.close();
}

function Load_Do()
{
  EDIT_HTML.insertHtml("{$PrintModel}");  
  EDIT_HTML.focus();
  <?php
  if($SAVE==1)
  {
  	?>
     alert("表单已保存！");
     <?php
}?>
}

function cool_textfield()
{
  URL="../../coolTextfield";
  loc_x=document.body.scrollLeft+event.clientX-event.offsetX-300;
  loc_y=document.body.scrollTop+event.clientY-event.offsetY+62;
  window.showModalDialog(URL,self,"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:320px;dialogHeight:140px;dialogTop:"+loc_y+"px;dialogLeft:"+loc_x+"px");
}

function cool_textarea()
{
  URL="../../coolTextarea";
  loc_x=document.body.scrollLeft+event.clientX-event.offsetX-300;
  loc_y=document.body.scrollTop+event.clientY-event.offsetY+62;
  window.showModalDialog(URL,self,"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:320px;dialogHeight:140px;dialogTop:"+loc_y+"px;dialogLeft:"+loc_x+"px");
}

function cool_listmenu()
{
  URL="../../coolListmenu";
  loc_x=document.body.scrollLeft+event.clientX-event.offsetX-300;
  loc_y=document.body.scrollTop+event.clientY-event.offsetY+62;
  window.showModalDialog(URL,self,"edge:raised;scroll:1;status:0;help:0;resizable:1;dialogWidth:320px;dialogHeight:293px;dialogTop:"+loc_y+"px;dialogLeft:"+loc_x+"px");
}

function cool_checkbox()
{
  URL="../../coolCheckbox";
  loc_x=document.body.scrollLeft+event.clientX-event.offsetX-300;
  loc_y=document.body.scrollTop+event.clientY-event.offsetY+62;
  window.showModalDialog(URL,self,"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:320px;dialogHeight:112px;dialogTop:"+loc_y+"px;dialogLeft:"+loc_x+"px");
}

function cool_calendar()
{
  URL="../../coolCalendar";
  loc_x=document.body.scrollLeft+event.clientX-event.offsetX-300;
  loc_y=document.body.scrollTop+event.clientY-event.offsetY+62;
  window.showModalDialog(URL,self,"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:320px;dialogHeight:112px;dialogTop:"+loc_y+"px;dialogLeft:"+loc_x+"px");
}

function cool_auto()
{
  URL="../../coolAuto";
  loc_x=document.body.scrollLeft+event.clientX-event.offsetX-300;
  loc_y=document.body.scrollTop+event.clientY-event.offsetY+62;
  window.showModalDialog(URL,self,"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:320px;dialogHeight:199px;dialogTop:"+loc_y+"px;dialogLeft:"+loc_x+"px");
}

function cool_calc()
{
  URL="../../coolCalc";
  loc_x=document.body.scrollLeft+event.clientX-event.offsetX-300;
  loc_y=document.body.scrollTop+event.clientY-event.offsetY+62;
  window.showModalDialog(URL,self,"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:320px;dialogHeight:172px;dialogTop:"+loc_y+"px;dialogLeft:"+loc_x+"px");
}
</script>
</head>

<body class="bodycolor" leftmargin="0" topmargin="0" onLoad="Load_Do();">

<table width="100%" height="100%" class="big" bgcolor="#000000" border=0 cellpadding="3" cellspacing="1" align="center">
 <tr bgcolor="#DDDDDD">
   <td class="TableHeader" colspan="2" height="20">
    <b>表单智能设计器</b>：<span class="small">首先，将网页设计工具或Word编辑好的表格框架粘贴到表单设计区。然后，创建表单控件。</span>
   </td>
 </tr> 
 <tr bgcolor="#DDDDDD">
  <td bgcolor="#DDDDDD" width="100%">
     <iframe id="EDIT_HTML" style="BACKGROUND-COLOR: buttonface" src="/Tpl/default/Public/rte" width="100%" height="100%" type="text/x-scriptlet" VIEWASTEXT></iframe>
   </td>
   <td valign="top" align="center">
     <table width="120" border="0" cellspacing="1" class="small" bgcolor="#000000" cellpadding="3" align="center">
      <tr class="TableHeader"><td align="center">表单控件</td></tr>
      <tr class="TableHeader"><td align="center"><button style="width:120;text-Align:left" onClick="cool_textfield()"><img src="/images/form/textfield.gif" align=absmiddle>单行输入框</button></td></tr>
      <tr class="TableHeader"><td align="center"><button style="width:120;text-Align:left" onClick="cool_textarea()"><img src="/images/form/textarea.gif" align=absmiddle>多行输入框</button></td></tr>
      <tr class="TableHeader"><td align="center"><button style="width:120;text-Align:left" onClick="cool_listmenu()"><img src="/images/form/listmenu.gif" align=absmiddle>下拉菜单</button></td></tr>
      <tr class="TableHeader"><td align="center"><button style="width:120;text-Align:left" onClick="cool_checkbox()"><img src="/images/form/checkbox.gif" align=absmiddle>单选框</button></td></tr>
      <tr class="TableHeader"><td align="center"><button style="width:120;text-Align:left" onClick="cool_calendar()"><img src="/images/form/calendar.gif" align=absmiddle>日期控件</button></td></tr>
      <tr class="TableHeader"><td align="center"><button style="width:120;text-Align:left" onClick="cool_auto()"><img src="/images/form/auto.gif" align=absmiddle>宏控件</button></td></tr>
      <tr class="TableHeader"><td align="center"><button style="width:120;text-Align:left" onClick="cool_calc()"><img src="/images/form/calc.gif" align=absmiddle>计算控件</button></td></tr>
     </table>
     <br>
     <table width="120" border="0" cellspacing="1" class="small" bgcolor="#000000" cellpadding="3" align="center">
      <tr class="TableHeader"><td align="center">保存与退出</td></tr>
      <form action="../../submit"  method="post" name="form1">
      <tr class="TableHeader"><td align="center"><button style="width:120;height:30;text-Align:center" onClick="send()"><b>保存表单</b></button></td></tr>
      <tr class="TableHeader"><td align="center"><button style="width:120;height:30;text-Align:center" onClick="myclose()"><b>关闭设计器</b></button></td></tr>
      <input type="hidden" name="CONTENT"  value="">
      <input type="hidden" name="CLOSE_FLAG"  value="">
      <input type="hidden" name="FORM_ID"  value="{$FormId}">
      </form>
    </table>
   </td>
 </tr>

</table>
<include file="Public:footer" />